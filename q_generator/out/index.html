<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Survey</title>
<style>
body{font-family: system-ui, -apple-system, Roboto, 'Segoe UI', Arial; padding:20px; max-width:900px; margin:auto;}
.page{display:none;}
.page.active{display:block;}
.controls{display:flex;justify-content:space-between;margin-top:18px;}
.question{margin:12px 0;padding:10px;border-radius:8px;background:#f8f8f8;}
fieldset.question{
        border:1px solid #ddd;
        padding:10px;
        border-radius:6px;
    }
.text-block{margin:8px 0;}
.page-indicator{text-align:center;margin-top:12px;color:#666}
button:disabled{opacity:.5;cursor:not-allowed}
</style>
</head><body>
<h1>Survey</h1>
<div id="pages">
<section class="page" data-index="0">
<h2>page 1</h2>
<div class="text-block">Hello!<br>    Welcome!</div>
<fieldset class="question">
<legend>Which one do you prefer?</legend>
<div><input type="radio" id="p0_q0_opt0" name="p0_q0" value="0"> <label for="p0_q0_opt0">windows</label></div>
<div><input type="radio" id="p0_q0_opt1" name="p0_q0" value="1"> <label for="p0_q0_opt1">macos</label></div>
<div><input type="radio" id="p0_q0_opt2" name="p0_q0" value="2"> <label for="p0_q0_opt2">gnu+linux</label></div>
</fieldset>
</section>
<section class="page" data-index="1">
<h2>page 2</h2>
<div class="text-block">Welcome to page 2!</div>
</section>
</div>
<div class="controls">
<div><button id="prevBtn">Previous</button></div>
<div><button id="nextBtn">Next</button></div>
</div>
<div class="page-indicator" id="pageIndicator"></div>
<script>
const PAGE_COUNT = 2;
const PAGE_SCRIPTS = [`console.log("Hello, World!");`,``];

    document.addEventListener('DOMContentLoaded', () => {
        // grab elements after DOM ready
        const pages = Array.from(document.querySelectorAll('.page'));
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const pageIndicator = document.getElementById('pageIndicator');

        let currentIndex = 0;
        const ran = new Array(PAGE_COUNT).fill(false); // ensure page scripts run once

        function showPage(idx) {
            if (idx < 0) idx = 0;
            if (idx >= PAGE_COUNT) idx = PAGE_COUNT - 1;
            currentIndex = idx;

            pages.forEach((p, i) => {
                if (i === idx) {
                    p.classList.add('active');
                    p.style.display = '';
                } else {
                    p.classList.remove('active');
                    p.style.display = 'none';
                }
            });

            if (prevBtn) prevBtn.disabled = (idx === 0);
            if (nextBtn) nextBtn.disabled = (idx === PAGE_COUNT - 1);
            if (pageIndicator) pageIndicator.textContent = "Page " + (idx + 1) + " of " + PAGE_COUNT;

            // Run page script once (if present)
            try {
                const scriptText = PAGE_SCRIPTS[idx];
                if (!ran[idx] && scriptText && scriptText.trim().length > 0) {
                    new Function(scriptText)();
                    ran[idx] = true;
                }
            } catch (e) {
                console.error('Error running page script for page', idx + 1, e);
            }
        }

        // defensive listener attachment with debug logs
        if (prevBtn) {
            prevBtn.addEventListener('click', () => {
                console.log('prev clicked, currentIndex=', currentIndex);
                showPage(currentIndex - 1);
            });
        } else {
            console.warn('prevBtn not found');
        }

        if (nextBtn) {
            nextBtn.addEventListener('click', () => {
                console.log('next clicked, currentIndex=', currentIndex);
                showPage(currentIndex + 1);
            });
        } else {
            console.warn('nextBtn not found');
        }

        // initialize first page
        showPage(0);
    });
    
</script>
</body></html>
